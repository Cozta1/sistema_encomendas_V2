{% extends 'encomendas/base.html' %}

{% block title %}Excluir Encomenda #{{ encomenda.numero_encomenda }} - Sistema de Encomendas{% endblock %}

{% block content %}
<div class="page-header">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h1><i class="bi bi-exclamation-triangle text-danger me-3"></i>Excluir Encomenda</h1>
            <p class="mb-0">Confirme a exclusão da encomenda #{{ encomenda.numero_encomenda }}</p>
        </div>
        <a href="{% url 'encomenda_detail' encomenda.pk %}" class="btn btn-outline-light">
            <i class="bi bi-arrow-left me-2"></i>Voltar
        </a>
    </div>
</div>

<div class="card border-danger">
    <div class="card-header bg-danger text-white">
        <h5 class="mb-0"><i class="bi bi-exclamation-triangle me-2"></i>Atenção!</h5>
    </div>
    <div class="card-body">
        <div class="alert alert-danger">
            <h6><i class="bi bi-info-circle me-2"></i>Esta ação não pode ser desfeita!</h6>
            <p class="mb-0">Ao excluir esta encomenda, todos os dados relacionados serão permanentemente removidos, incluindo:</p>
            <ul class="mt-2 mb-0">
                <li>Todos os itens da encomenda</li>
                <li>Informações de entrega (se existirem)</li>
                <li>Histórico de alterações</li>
            </ul>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <h6>Detalhes da Encomenda:</h6>
                <table class="table table-sm">
                    <tr>
                        <td><strong>Número:</strong></td>
                        <td>#{{ encomenda.numero_encomenda }}</td>
                    </tr>
                    <tr>
                        <td><strong>Cliente:</strong></td>
                        <td>{{ encomenda.cliente.nome }}</td>
                    </tr>
                    <tr>
                        <td><strong>Status:</strong></td>
                        <td>
                            <span class="status-badge status-{{ encomenda.status }}">
                                {{ encomenda.get_status_display }}
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Data:</strong></td>
                        <td>{{ encomenda.data_criacao|date:"d/m/Y H:i" }}</td>
                    </tr>
                    <tr>
                        <td><strong>Valor:</strong></td>
                        <td>R$ {{ encomenda.valor_total|floatformat:2 }}</td>
                    </tr>
                </table>
            </div>
            
            <div class="col-md-6">
                <h6>Itens da Encomenda:</h6>
                {% if encomenda.itens.all %}
                    <ul class="list-group list-group-flush">
                        {% for item in encomenda.itens.all %}
                        <li class="list-group-item px-0 py-1">
                            <small>
                                {{ item.quantidade }}x {{ item.produto.nome }}
                                <span class="text-muted">(R$ {{ item.valor_total|floatformat:2 }})</span>
                            </small>
                        </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted">Nenhum item cadastrado</p>
                {% endif %}
            </div>
        </div>
        
        <form method="post" class="mt-4">
            {% csrf_token %}
            <div class="d-flex justify-content-between">
                <a href="{% url 'encomenda_detail' encomenda.pk %}" class="btn btn-secondary">
                    <i class="bi bi-x-circle me-2"></i>Cancelar
                </a>
                <button type="submit" class="btn btn-danger">
                    <i class="bi bi-trash me-2"></i>Sim, Excluir Encomenda
                </button>
            </div>
        </form>
    </div>
</div>

<div class="mt-4">
    <div class="alert alert-info">
        <h6><i class="bi bi-lightbulb me-2"></i>Alternativas à exclusão:</h6>
        <p class="mb-2">Se você não deseja excluir permanentemente, considere:</p>
        <ul class="mb-0">
            <li><strong>Cancelar a encomenda:</strong> Altere o status para "Cancelada" em vez de excluir</li>
            <li><strong>Editar os dados:</strong> Corrija informações incorretas através da edição</li>
            <li><strong>Arquivar:</strong> Mantenha o registro para histórico e controle</li>
        </ul>
    </div>
</div>
{% endblock %}
